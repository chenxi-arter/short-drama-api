<svg width="1400" height="1000" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <style>
      .entity-box { fill: #f8f9fa; stroke: #343a40; stroke-width: 2; }
      .entity-title { fill: #495057; font-family: Arial, sans-serif; font-size: 14px; font-weight: bold; }
      .entity-field { fill: #6c757d; font-family: Arial, sans-serif; font-size: 11px; }
      .primary-key { fill: #dc3545; font-weight: bold; }
      .foreign-key { fill: #007bff; }
      .relationship-line { stroke: #6c757d; stroke-width: 2; fill: none; }
      .one-to-many { stroke: #28a745; }
      .many-to-many { stroke: #ffc107; }
      .one-to-one { stroke: #17a2b8; }
    </style>
  </defs>
  
  <!-- Title -->
  <text x="700" y="30" text-anchor="middle" class="entity-title" font-size="18">短剧API系统 - 实体关系图 (ER Diagram)</text>
  
  <!-- User Entity -->
  <g id="user-entity">
    <rect x="50" y="60" width="180" height="140" class="entity-box"/>
    <text x="140" y="80" text-anchor="middle" class="entity-title">User (用户)</text>
    <line x1="60" y1="85" x2="220" y2="85" stroke="#343a40" stroke-width="1"/>
    <text x="60" y="100" class="entity-field primary-key">🔑 id: bigint (PK)</text>
    <text x="60" y="115" class="entity-field">first_name: varchar(255)</text>
    <text x="60" y="130" class="entity-field">last_name: varchar(255)</text>
    <text x="60" y="145" class="entity-field">username: varchar(255)</text>
    <text x="60" y="160" class="entity-field">is_active: tinyint</text>
    <text x="60" y="175" class="entity-field">created_at: timestamp</text>
    <text x="60" y="190" class="entity-field">🔗 comments: Comment[]</text>
  </g>
  
  <!-- RefreshToken Entity -->
  <g id="refresh-token-entity">
    <rect x="280" y="60" width="200" height="160" class="entity-box"/>
    <text x="380" y="80" text-anchor="middle" class="entity-title">RefreshToken (刷新令牌)</text>
    <line x1="290" y1="85" x2="470" y2="85" stroke="#343a40" stroke-width="1"/>
    <text x="290" y="100" class="entity-field primary-key">🔑 id: int (PK)</text>
    <text x="290" y="115" class="entity-field foreign-key">🔗 user_id: bigint (FK)</text>
    <text x="290" y="130" class="entity-field">token: varchar(255)</text>
    <text x="290" y="145" class="entity-field">expires_at: timestamp</text>
    <text x="290" y="160" class="entity-field">created_at: timestamp</text>
    <text x="290" y="175" class="entity-field">is_revoked: tinyint</text>
    <text x="290" y="190" class="entity-field">device_info: varchar(500)</text>
    <text x="290" y="205" class="entity-field">ip_address: varchar(45)</text>
  </g>
  
  <!-- Category Entity -->
  <g id="category-entity">
    <rect x="520" y="60" width="180" height="100" class="entity-box"/>
    <text x="610" y="80" text-anchor="middle" class="entity-title">Category (分类)</text>
    <line x1="530" y1="85" x2="690" y2="85" stroke="#343a40" stroke-width="1"/>
    <text x="530" y="100" class="entity-field primary-key">🔑 id: int (PK)</text>
    <text x="530" y="115" class="entity-field">name: varchar(50)</text>
    <text x="530" y="130" class="entity-field">🔗 series: Series[]</text>
    <text x="530" y="145" class="entity-field">🔗 shortVideos: ShortVideo[]</text>
  </g>
  
  <!-- Tag Entity -->
  <g id="tag-entity">
    <rect x="730" y="60" width="180" height="100" class="entity-box"/>
    <text x="820" y="80" text-anchor="middle" class="entity-title">Tag (标签)</text>
    <line x1="740" y1="85" x2="900" y2="85" stroke="#343a40" stroke-width="1"/>
    <text x="740" y="100" class="entity-field primary-key">🔑 id: int (PK)</text>
    <text x="740" y="115" class="entity-field">name: varchar(30)</text>
    <text x="740" y="130" class="entity-field">🔗 series: Series[]</text>
    <text x="740" y="145" class="entity-field">🔗 episodes: Episode[]</text>
  </g>
  
  <!-- Series Entity -->
  <g id="series-entity">
    <rect x="50" y="250" width="220" height="220" class="entity-box"/>
    <text x="160" y="270" text-anchor="middle" class="entity-title">Series (剧集系列)</text>
    <line x1="60" y1="275" x2="260" y2="275" stroke="#343a40" stroke-width="1"/>
    <text x="60" y="290" class="entity-field primary-key">🔑 id: int (PK)</text>
    <text x="60" y="305" class="entity-field foreign-key">🔗 category_id: int (FK)</text>
    <text x="60" y="320" class="entity-field">title: varchar(255)</text>
    <text x="60" y="335" class="entity-field">description: text</text>
    <text x="60" y="350" class="entity-field">cover_url: varchar(255)</text>
    <text x="60" y="365" class="entity-field">total_episodes: int</text>
    <text x="60" y="380" class="entity-field">play_count: int</text>
    <text x="60" y="395" class="entity-field">status: varchar</text>
    <text x="60" y="410" class="entity-field">up_status: varchar(50)</text>
    <text x="60" y="425" class="entity-field">up_count: int</text>
    <text x="60" y="440" class="entity-field">starring: text</text>
    <text x="60" y="455" class="entity-field">🔗 episodes: Episode[]</text>
  </g>
  
  <!-- Episode Entity -->
  <g id="episode-entity">
    <rect x="320" y="250" width="200" height="200" class="entity-box"/>
    <text x="420" y="270" text-anchor="middle" class="entity-title">Episode (剧集)</text>
    <line x1="330" y1="275" x2="510" y2="275" stroke="#343a40" stroke-width="1"/>
    <text x="330" y="290" class="entity-field primary-key">🔑 id: int (PK)</text>
    <text x="330" y="305" class="entity-field foreign-key">🔗 series_id: int (FK)</text>
    <text x="330" y="320" class="entity-field">episode_number: int</text>
    <text x="330" y="335" class="entity-field">title: varchar(255)</text>
    <text x="330" y="350" class="entity-field">duration: int</text>
    <text x="330" y="365" class="entity-field">status: varchar</text>
    <text x="330" y="380" class="entity-field">play_count: int</text>
    <text x="330" y="395" class="entity-field">has_sequel: boolean</text>
    <text x="330" y="410" class="entity-field">created_at: timestamp</text>
    <text x="330" y="425" class="entity-field">🔗 urls: EpisodeUrl[]</text>
    <text x="330" y="440" class="entity-field">🔗 comments: Comment[]</text>
  </g>
  
  <!-- EpisodeUrl Entity -->
  <g id="episode-url-entity">
    <rect x="570" y="250" width="200" height="160" class="entity-box"/>
    <text x="670" y="270" text-anchor="middle" class="entity-title">EpisodeUrl (播放地址)</text>
    <line x1="580" y1="275" x2="760" y2="275" stroke="#343a40" stroke-width="1"/>
    <text x="580" y="290" class="entity-field primary-key">🔑 id: int (PK)</text>
    <text x="580" y="305" class="entity-field foreign-key">🔗 episode_id: int (FK)</text>
    <text x="580" y="320" class="entity-field">url: varchar(255)</text>
    <text x="580" y="335" class="entity-field">quality: varchar(20)</text>
    <text x="580" y="350" class="entity-field">file_size: bigint</text>
    <text x="580" y="365" class="entity-field">format: varchar(10)</text>
    <text x="580" y="380" class="entity-field">created_at: timestamp</text>
    <text x="580" y="395" class="entity-field">updated_at: timestamp</text>
  </g>
  
  <!-- Comment Entity -->
  <g id="comment-entity">
    <rect x="50" y="520" width="200" height="160" class="entity-box"/>
    <text x="150" y="540" text-anchor="middle" class="entity-title">Comment (评论/弹幕)</text>
    <line x1="60" y1="545" x2="240" y2="545" stroke="#343a40" stroke-width="1"/>
    <text x="60" y="560" class="entity-field primary-key">🔑 id: int (PK)</text>
    <text x="60" y="575" class="entity-field foreign-key">🔗 user_id: bigint (FK)</text>
    <text x="60" y="590" class="entity-field foreign-key">🔗 episode_id: int (FK)</text>
    <text x="60" y="605" class="entity-field">content: text</text>
    <text x="60" y="620" class="entity-field">appear_second: int</text>
    <text x="60" y="635" class="entity-field">created_at: timestamp</text>
  </g>
  
  <!-- WatchProgress Entity -->
  <g id="watch-progress-entity">
    <rect x="300" y="520" width="200" height="140" class="entity-box"/>
    <text x="400" y="540" text-anchor="middle" class="entity-title">WatchProgress (观看进度)</text>
    <line x1="310" y1="545" x2="490" y2="545" stroke="#343a40" stroke-width="1"/>
    <text x="310" y="560" class="entity-field primary-key">🔑 user_id: bigint (PK)</text>
    <text x="310" y="575" class="entity-field primary-key">🔑 episode_id: int (PK)</text>
    <text x="310" y="590" class="entity-field">stop_at_second: int</text>
    <text x="310" y="605" class="entity-field">updated_at: timestamp</text>
  </g>
  
  <!-- ShortVideo Entity -->
  <g id="short-video-entity">
    <rect x="550" y="520" width="200" height="180" class="entity-box"/>
    <text x="650" y="540" text-anchor="middle" class="entity-title">ShortVideo (短视频)</text>
    <line x1="560" y1="545" x2="740" y2="545" stroke="#343a40" stroke-width="1"/>
    <text x="560" y="560" class="entity-field primary-key">🔑 id: int (PK)</text>
    <text x="560" y="575" class="entity-field foreign-key">🔗 category_id: int (FK)</text>
    <text x="560" y="590" class="entity-field">title: varchar(255)</text>
    <text x="560" y="605" class="entity-field">description: text</text>
    <text x="560" y="620" class="entity-field">cover_url: varchar(255)</text>
    <text x="560" y="635" class="entity-field">video_url: varchar(255)</text>
    <text x="560" y="650" class="entity-field">duration: int</text>
    <text x="560" y="665" class="entity-field">play_count: int</text>
    <text x="560" y="680" class="entity-field">like_count: int</text>
  </g>
  
  <!-- Relationship Lines -->
  
  <!-- User -> RefreshToken (1:N) -->
  <path d="M 230 140 L 280 140" class="relationship-line one-to-many"/>
  <text x="255" y="135" class="entity-field" font-size="10">1:N</text>
  
  <!-- User -> Comment (1:N) -->
  <path d="M 140 200 L 140 520" class="relationship-line one-to-many"/>
  <text x="145" y="360" class="entity-field" font-size="10">1:N</text>
  
  <!-- User -> WatchProgress (1:N) -->
  <path d="M 230 180 L 300 560" class="relationship-line one-to-many"/>
  <text x="265" y="370" class="entity-field" font-size="10">1:N</text>
  
  <!-- Category -> Series (1:N) -->
  <path d="M 610 160 L 160 250" class="relationship-line one-to-many"/>
  <text x="385" y="205" class="entity-field" font-size="10">1:N</text>
  
  <!-- Category -> ShortVideo (1:N) -->
  <path d="M 610 160 L 650 520" class="relationship-line one-to-many"/>
  <text x="630" y="340" class="entity-field" font-size="10">1:N</text>
  
  <!-- Series -> Episode (1:N) -->
  <path d="M 270 350 L 320 350" class="relationship-line one-to-many"/>
  <text x="295" y="345" class="entity-field" font-size="10">1:N</text>
  
  <!-- Episode -> EpisodeUrl (1:N) -->
  <path d="M 520 330 L 570 330" class="relationship-line one-to-many"/>
  <text x="545" y="325" class="entity-field" font-size="10">1:N</text>
  
  <!-- Episode -> Comment (1:N) -->
  <path d="M 420 450 L 150 520" class="relationship-line one-to-many"/>
  <text x="285" y="485" class="entity-field" font-size="10">1:N</text>
  
  <!-- Episode -> WatchProgress (1:N) -->
  <path d="M 420 450 L 400 520" class="relationship-line one-to-many"/>
  <text x="410" y="485" class="entity-field" font-size="10">1:N</text>
  
  <!-- Tag -> Series (M:N) -->
  <path d="M 820 160 L 160 250" class="relationship-line many-to-many"/>
  <text x="490" y="205" class="entity-field" font-size="10">M:N</text>
  
  <!-- Tag -> Episode (M:N) -->
  <path d="M 820 160 L 420 250" class="relationship-line many-to-many"/>
  <text x="620" y="205" class="entity-field" font-size="10">M:N</text>
  
  <!-- Legend -->
  <g id="legend">
    <rect x="950" y="60" width="400" height="200" fill="#f8f9fa" stroke="#343a40" stroke-width="1"/>
    <text x="1150" y="80" text-anchor="middle" class="entity-title">图例 (Legend)</text>
    <line x1="960" y1="85" x2="1340" y2="85" stroke="#343a40" stroke-width="1"/>
    
    <text x="970" y="105" class="entity-field primary-key">🔑 主键 (Primary Key)</text>
    <text x="970" y="120" class="entity-field foreign-key">🔗 外键 (Foreign Key)</text>
    <text x="970" y="135" class="entity-field">🔗 关系字段 (Relationship Field)</text>
    
    <line x1="970" y1="150" x2="1020" y2="150" class="relationship-line one-to-many"/>
    <text x="1030" y="155" class="entity-field">一对多关系 (1:N)</text>
    
    <line x1="970" y1="170" x2="1020" y2="170" class="relationship-line many-to-many"/>
    <text x="1030" y="175" class="entity-field">多对多关系 (M:N)</text>
    
    <line x1="970" y1="190" x2="1020" y2="190" class="relationship-line one-to-one"/>
    <text x="1030" y="195" class="entity-field">一对一关系 (1:1)</text>
    
    <text x="970" y="220" class="entity-field" font-size="10">注：联合主键用多个🔑标识</text>
    <text x="970" y="235" class="entity-field" font-size="10">中间表：series_tags, episode_tags</text>
  </g>
  
  <!-- Footer -->
  <text x="700" y="950" text-anchor="middle" class="entity-field" font-size="12">短剧API系统数据库实体关系图 - 包含9个核心实体及其关联关系</text>
  <text x="700" y="970" text-anchor="middle" class="entity-field" font-size="10">生成时间: 2024年 | 版本: v1.0.0</text>
</svg>