# å¹¿å‘ŠæŠ•æ”¾ç³»ç»Ÿ - ç®¡ç†åå°ä½¿ç”¨æŒ‡å—

## ğŸ“‹ ç³»ç»Ÿæ¦‚è¿°

å¹¿å‘ŠæŠ•æ”¾ç³»ç»Ÿå·²å®Œæˆå¼€å‘å¹¶é€šè¿‡æµ‹è¯•ï¼ŒåŒ…å«ä»¥ä¸‹æ ¸å¿ƒåŠŸèƒ½ï¼š
- âœ… å¹¿å‘Šå¹³å°ç®¡ç†
- âœ… æŠ•æ”¾è®¡åˆ’ç®¡ç†
- âœ… äº‹ä»¶è¿½è¸ª
- âœ… è½¬åŒ–è¿½è¸ª
- âœ… æ•°æ®ç»Ÿè®¡åˆ†æ

---

## ğŸ¯ æ ¸å¿ƒåŠŸèƒ½

### 1. å¹¿å‘Šå¹³å°ç®¡ç†

#### æŸ¥çœ‹æ‰€æœ‰å¹³å°
```
GET /api/admin/advertising/platforms
```

**é»˜è®¤å¹³å°åˆ—è¡¨**ï¼š
- æŠ–éŸ³ (tiktok)
- å¾®ä¿¡ (wechat)
- ç™¾åº¦ (baidu)
- Google (google)
- å¾®åš (weibo)
- å°çº¢ä¹¦ (xiaohongshu)
- å¿«æ‰‹ (kuaishou)

#### åˆ›å»ºæ–°å¹³å°
```
POST /api/admin/advertising/platforms
```

**è¯·æ±‚ç¤ºä¾‹**ï¼š
```json
{
  "name": "å¿«æ‰‹",
  "code": "kuaishou",
  "description": "å¿«æ‰‹çŸ­è§†é¢‘å¹³å°",
  "color": "#ff6600",
  "sortOrder": 7,
  "isEnabled": true
}
```

---

### 2. æŠ•æ”¾è®¡åˆ’ç®¡ç†

#### åˆ›å»ºæŠ•æ”¾è®¡åˆ’

```
POST /api/admin/advertising/campaigns
```

**è¯·æ±‚ç¤ºä¾‹**ï¼š
```json
{
  "name": "åŒåä¸€å¾®ä¿¡æ¨å¹¿",
  "description": "åŒåä¸€æ´»åŠ¨å¾®ä¿¡æ¸ é“æ¨å¹¿",
  "platform": "wechat",
  "targetUrl": "https://your-app.com?utm_source=wechat",
  "budget": 10000,
  "targetClicks": 50000,
  "targetConversions": 5000,
  "startDate": "2025-11-17T00:00:00Z",
  "endDate": "2025-11-30T23:59:59Z"
}
```

**å“åº”ç¤ºä¾‹**ï¼š
```json
{
  "code": 200,
  "message": "Campaign created successfully",
  "data": {
    "id": "4",
    "name": "åŒåä¸€å¾®ä¿¡æ¨å¹¿",
    "campaignCode": "WX_20251117_8FA5D0",
    "platform": "wechat",
    "status": "draft",
    "targetUrl": "https://your-app.com?utm_source=wechat",
    "budget": "10000.00",
    "targetClicks": 50000,
    "startDate": "2025-11-17T00:00:00.000Z",
    "endDate": "2025-11-30T23:59:59.000Z"
  }
}
```

**é‡è¦å­—æ®µè¯´æ˜**ï¼š
- `campaignCode`: è‡ªåŠ¨ç”Ÿæˆçš„å”¯ä¸€æ ‡è¯†ç ï¼Œç”¨äºè¿½è¸ªï¼ˆå¦‚ï¼šWX_20251117_8FA5D0ï¼‰
- `status`: è®¡åˆ’çŠ¶æ€ï¼ˆdraft/active/paused/completed/cancelledï¼‰
- `platform`: å¹³å°ä»£ç ï¼ˆå¿…é¡»æ˜¯å·²å­˜åœ¨çš„å¹³å°ï¼‰

#### æŸ¥çœ‹æ‰€æœ‰æŠ•æ”¾è®¡åˆ’

```
GET /api/admin/advertising/campaigns
```

**æŸ¥è¯¢å‚æ•°**ï¼š
- `platform`: æŒ‰å¹³å°ç­›é€‰ï¼ˆå¦‚ï¼šwechatï¼‰
- `status`: æŒ‰çŠ¶æ€ç­›é€‰ï¼ˆå¦‚ï¼šactiveï¼‰
- `page`: é¡µç ï¼ˆé»˜è®¤ï¼š1ï¼‰
- `limit`: æ¯é¡µæ•°é‡ï¼ˆé»˜è®¤ï¼š10ï¼‰

#### æŸ¥çœ‹å•ä¸ªè®¡åˆ’è¯¦æƒ…

```
GET /api/admin/advertising/campaigns/:id
```

#### æ›´æ–°æŠ•æ”¾è®¡åˆ’

```
PUT /api/admin/advertising/campaigns/:id
```

**å¯æ›´æ–°å­—æ®µ**ï¼š
```json
{
  "name": "æ›´æ–°åçš„è®¡åˆ’åç§°",
  "description": "æ›´æ–°åçš„æè¿°",
  "budget": 15000,
  "status": "active",
  "endDate": "2025-12-31T23:59:59Z"
}
```

#### åˆ é™¤æŠ•æ”¾è®¡åˆ’

```
DELETE /api/admin/advertising/campaigns/:id
```

---

### 3. æ•°æ®ç»Ÿè®¡åˆ†æ

#### è·å–è®¡åˆ’ç»Ÿè®¡æ•°æ®

```
GET /api/admin/advertising/campaigns/:id/stats
```

**æŸ¥è¯¢å‚æ•°**ï¼š
- `startDate`: å¼€å§‹æ—¥æœŸï¼ˆå¦‚ï¼š2025-11-01ï¼‰
- `endDate`: ç»“æŸæ—¥æœŸï¼ˆå¦‚ï¼š2025-11-30ï¼‰

**å“åº”ç¤ºä¾‹**ï¼š
```json
{
  "code": 200,
  "data": {
    "campaignId": "4",
    "campaignName": "åŒåä¸€å¾®ä¿¡æ¨å¹¿",
    "campaignCode": "WX_20251117_8FA5D0",
    "totalClicks": 1250,
    "totalViews": 3500,
    "totalConversions": 125,
    "conversionRate": 0.1000,
    "cost": 2500.00,
    "cpc": 2.00,
    "cpa": 20.00,
    "eventBreakdown": {
      "click": 1250,
      "view": 3500,
      "play": 890,
      "register": 45
    },
    "conversionBreakdown": {
      "register": 45,
      "first_play": 60,
      "subscription": 20
    }
  }
}
```

#### è·å–å®æ—¶äº‹ä»¶åˆ—è¡¨

```
GET /api/admin/advertising/campaigns/:id/events
```

**æŸ¥è¯¢å‚æ•°**ï¼š
- `eventType`: äº‹ä»¶ç±»å‹ç­›é€‰ï¼ˆclick/view/play/registerï¼‰
- `startDate`: å¼€å§‹æ—¶é—´
- `endDate`: ç»“æŸæ—¶é—´
- `limit`: è¿”å›æ•°é‡ï¼ˆé»˜è®¤ï¼š100ï¼‰

#### è·å–è½¬åŒ–è®°å½•

```
GET /api/admin/advertising/campaigns/:id/conversions
```

**æŸ¥è¯¢å‚æ•°**ï¼š
- `conversionType`: è½¬åŒ–ç±»å‹ï¼ˆregister/first_play/subscription/purchaseï¼‰
- `startDate`: å¼€å§‹æ—¶é—´
- `endDate`: ç»“æŸæ—¶é—´
- `limit`: è¿”å›æ•°é‡ï¼ˆé»˜è®¤ï¼š100ï¼‰

---

## ğŸ”— æŠ•æ”¾é“¾æ¥ç”Ÿæˆ

### URLæ ¼å¼

åˆ›å»ºæŠ•æ”¾è®¡åˆ’åï¼Œä½¿ç”¨ç”Ÿæˆçš„ `campaignCode` æ„å»ºæŠ•æ”¾é“¾æ¥ï¼š

```
https://your-app.com?campaign={campaignCode}
æˆ–
https://your-app.com?c={campaignCode}
```

### ç¤ºä¾‹

å¦‚æœ `campaignCode` æ˜¯ `WX_20251117_8FA5D0`ï¼ŒæŠ•æ”¾é“¾æ¥ä¸ºï¼š

```
https://your-app.com?campaign=WX_20251117_8FA5D0
```

ç”¨æˆ·é€šè¿‡æ­¤é“¾æ¥è¿›å…¥åº”ç”¨åï¼Œå®¢æˆ·ç«¯ä¼šè‡ªåŠ¨è¿½è¸ªæ‰€æœ‰è¡Œä¸ºã€‚

---

## ğŸ“Š æ•°æ®æŒ‡æ ‡è¯´æ˜

### äº‹ä»¶æŒ‡æ ‡

| æŒ‡æ ‡ | è¯´æ˜ |
|------|------|
| æ€»ç‚¹å‡»é‡ (Total Clicks) | ç”¨æˆ·ç‚¹å‡»å¹¿å‘Šæˆ–é¡µé¢å…ƒç´ çš„æ¬¡æ•° |
| æ€»æµè§ˆé‡ (Total Views) | é¡µé¢æµè§ˆæ¬¡æ•° |
| æ’­æ”¾é‡ (Play Count) | è§†é¢‘æ’­æ”¾æ¬¡æ•° |
| æ³¨å†Œäº‹ä»¶ (Register Events) | æ³¨å†Œé¡µé¢è®¿é—®æ¬¡æ•° |

### è½¬åŒ–æŒ‡æ ‡

| æŒ‡æ ‡ | è¯´æ˜ |
|------|------|
| æ³¨å†Œè½¬åŒ– (Register) | å®Œæˆæ³¨å†Œçš„ç”¨æˆ·æ•° |
| é¦–æ¬¡æ’­æ”¾è½¬åŒ– (First Play) | é¦–æ¬¡æ’­æ”¾è§†é¢‘çš„ç”¨æˆ·æ•° |
| è®¢é˜…è½¬åŒ– (Subscription) | è®¢é˜…ä¼šå‘˜çš„ç”¨æˆ·æ•° |
| è´­ä¹°è½¬åŒ– (Purchase) | å®Œæˆè´­ä¹°çš„ç”¨æˆ·æ•° |

### è®¡ç®—æŒ‡æ ‡

| æŒ‡æ ‡ | è®¡ç®—å…¬å¼ | è¯´æ˜ |
|------|---------|------|
| è½¬åŒ–ç‡ (Conversion Rate) | è½¬åŒ–æ•° / ç‚¹å‡»æ•° Ã— 100% | ç‚¹å‡»è½¬åŒ–ä¸ºå®é™…è¡ŒåŠ¨çš„æ¯”ä¾‹ |
| CPC (Cost Per Click) | æ€»èŠ±è´¹ / æ€»ç‚¹å‡»æ•° | å•æ¬¡ç‚¹å‡»æˆæœ¬ |
| CPA (Cost Per Action) | æ€»èŠ±è´¹ / æ€»è½¬åŒ–æ•° | å•æ¬¡è·å®¢æˆæœ¬ |
| ROI (Return on Investment) | (æ”¶ç›Š - æˆæœ¬) / æˆæœ¬ Ã— 100% | æŠ•èµ„å›æŠ¥ç‡ |

---

## ğŸ¯ ä½¿ç”¨æµç¨‹

### 1. åˆ›å»ºæŠ•æ”¾è®¡åˆ’

```bash
# ç¤ºä¾‹ï¼šåˆ›å»ºå¾®ä¿¡æ¸ é“æ¨å¹¿è®¡åˆ’
curl -X POST http://localhost:8080/api/admin/advertising/campaigns \
  -H "Content-Type: application/json" \
  -d '{
    "name": "å¾®ä¿¡æœ‹å‹åœˆæ¨å¹¿",
    "platform": "wechat",
    "targetUrl": "https://your-app.com",
    "startDate": "2025-11-17T00:00:00Z",
    "budget": 5000,
    "targetClicks": 20000
  }'
```

### 2. è·å–æŠ•æ”¾é“¾æ¥

ä»å“åº”ä¸­è·å– `campaignCode`ï¼Œä¾‹å¦‚ï¼š`WX_20251117_8FA5D0`

ç”ŸæˆæŠ•æ”¾é“¾æ¥ï¼š
```
https://your-app.com?campaign=WX_20251117_8FA5D0
```

### 3. æŠ•æ”¾å¹¿å‘Š

å°†ç”Ÿæˆçš„é“¾æ¥ç”¨äºï¼š
- å¾®ä¿¡æœ‹å‹åœˆå¹¿å‘Š
- å…¬ä¼—å·æ¨æ–‡
- çŸ­è§†é¢‘å¹³å°
- æœç´¢å¼•æ“å¹¿å‘Š
- å…¶ä»–æ¨å¹¿æ¸ é“

### 4. ç›‘æ§æ•°æ®

å®šæœŸæŸ¥çœ‹è®¡åˆ’ç»Ÿè®¡æ•°æ®ï¼š

```bash
# æŸ¥çœ‹è®¡åˆ’ç»Ÿè®¡
curl http://localhost:8080/api/admin/advertising/campaigns/4/stats

# æŸ¥çœ‹å®æ—¶äº‹ä»¶
curl http://localhost:8080/api/admin/advertising/campaigns/4/events?limit=50

# æŸ¥çœ‹è½¬åŒ–è®°å½•
curl http://localhost:8080/api/admin/advertising/campaigns/4/conversions
```

### 5. ä¼˜åŒ–è°ƒæ•´

æ ¹æ®æ•°æ®åˆ†æç»“æœï¼š
- è°ƒæ•´é¢„ç®—åˆ†é…
- ä¼˜åŒ–æŠ•æ”¾æ—¶é—´
- ä¿®æ”¹ç›®æ ‡URL
- æš‚åœ/æ¿€æ´»è®¡åˆ’

---

## ğŸ“± å‰ç«¯é›†æˆ

å®¢æˆ·ç«¯éœ€è¦é›†æˆè¿½è¸ªä»£ç ï¼Œå‚è€ƒæ–‡æ¡£ï¼š
- `docs/vue-client-advertising-tracking.md` - Vueå®¢æˆ·ç«¯å®Œæ•´é›†æˆæŒ‡å—

å…³é”®æ­¥éª¤ï¼š
1. ä»URLè·å– `campaign` å‚æ•°
2. ä¿å­˜åˆ° localStorageï¼ˆ24å°æ—¶æœ‰æ•ˆï¼‰
3. è‡ªåŠ¨è¿½è¸ªé¡µé¢æµè§ˆ
4. æ‰‹åŠ¨è¿½è¸ªå…³é”®è¡Œä¸ºï¼ˆæ’­æ”¾ã€æ³¨å†Œã€è®¢é˜…ï¼‰

---

## ğŸ” æµ‹è¯•éªŒè¯

### å·²å®Œæˆçš„æµ‹è¯•

âœ… **æµ‹è¯•Campaign**: `WX_20251117_8FA5D0`

**æµ‹è¯•ç»“æœ**ï¼š
- âœ… ç‚¹å‡»äº‹ä»¶è¿½è¸ª - æˆåŠŸ
- âœ… æµè§ˆäº‹ä»¶è¿½è¸ª - æˆåŠŸ
- âœ… æ’­æ”¾äº‹ä»¶è¿½è¸ª - æˆåŠŸ
- âœ… æ‰¹é‡äº‹ä»¶è¿½è¸ª - æˆåŠŸï¼ˆ3ä¸ªäº‹ä»¶ï¼‰
- âœ… æ³¨å†Œè½¬åŒ–è¿½è¸ª - æˆåŠŸ
- âœ… é¦–æ¬¡æ’­æ”¾è½¬åŒ– - æˆåŠŸ
- âœ… è®¢é˜…è½¬åŒ–è¿½è¸ª - æˆåŠŸ

### æ•°æ®åº“éªŒè¯

```sql
-- æŸ¥çœ‹æµ‹è¯•æ•°æ®
SELECT * FROM advertising_events 
WHERE campaign_code = 'WX_20251117_8FA5D0';

SELECT * FROM advertising_conversions 
WHERE campaign_code = 'WX_20251117_8FA5D0';
```

---

## ğŸ’¡ æœ€ä½³å®è·µ

### 1. å‘½åè§„èŒƒ

**è®¡åˆ’å‘½åå»ºè®®**ï¼š
- åŒ…å«å¹³å°åç§°ï¼šå¦‚"å¾®ä¿¡-åŒåä¸€æ´»åŠ¨"
- åŒ…å«æ—¶é—´å‘¨æœŸï¼šå¦‚"2025å¹´11æœˆæ¨å¹¿"
- åŒ…å«ç›®æ ‡ï¼šå¦‚"æ–°ç”¨æˆ·æ³¨å†Œæ´»åŠ¨"

### 2. é¢„ç®—è®¾ç½®

- è®¾ç½®åˆç†çš„æ—¥é¢„ç®—å’Œæ€»é¢„ç®—
- æ ¹æ®å†å²æ•°æ®è®¾å®šç›®æ ‡ç‚¹å‡»é‡
- é¢„ç•™10-20%çš„è°ƒæ•´ç©ºé—´

### 3. æ—¶é—´è§„åˆ’

- æå‰1-2å¤©åˆ›å»ºè®¡åˆ’
- è®¾ç½®æ˜ç¡®çš„å¼€å§‹å’Œç»“æŸæ—¶é—´
- é‡è¦æ´»åŠ¨å»ºè®®å»¶é•¿1-2å¤©è§‚å¯ŸæœŸ

### 4. æ•°æ®ç›‘æ§

- æ¯æ—¥æŸ¥çœ‹å…³é”®æŒ‡æ ‡
- å…³æ³¨è½¬åŒ–ç‡å˜åŒ–è¶‹åŠ¿
- åŠæ—¶è°ƒæ•´æŠ•æ”¾ç­–ç•¥

### 5. A/Bæµ‹è¯•

- åŒä¸€æ¸ é“åˆ›å»ºå¤šä¸ªè®¡åˆ’
- ä½¿ç”¨ä¸åŒçš„è½åœ°é¡µURL
- å¯¹æ¯”è½¬åŒ–æ•ˆæœé€‰æ‹©æœ€ä¼˜æ–¹æ¡ˆ

---

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **campaignCodeå”¯ä¸€æ€§**
   - æ¯ä¸ªè®¡åˆ’çš„codeè‡ªåŠ¨ç”Ÿæˆï¼Œå…¨å±€å”¯ä¸€
   - ä¸å¯ä¿®æ”¹ï¼Œåˆ é™¤è®¡åˆ’åcodeä¸å¯å¤ç”¨

2. **æ—¶é—´è®¾ç½®**
   - å¼€å§‹æ—¶é—´ä¸èƒ½æ—©äºå½“å‰æ—¶é—´
   - ç»“æŸæ—¶é—´å¿…é¡»æ™šäºå¼€å§‹æ—¶é—´
   - ä½¿ç”¨ISO 8601æ ¼å¼ï¼ˆå¦‚ï¼š2025-11-17T00:00:00Zï¼‰

3. **å¹³å°ä»£ç **
   - å¿…é¡»ä½¿ç”¨å·²å­˜åœ¨çš„å¹³å°code
   - åŒºåˆ†å¤§å°å†™
   - å¸¸ç”¨ï¼šwechat, tiktok, baidu, google

4. **æ•°æ®ä¿ç•™**
   - äº‹ä»¶æ•°æ®æ°¸ä¹…ä¿ç•™
   - è½¬åŒ–æ•°æ®æ°¸ä¹…ä¿ç•™
   - åˆ é™¤è®¡åˆ’ä¼šçº§è”åˆ é™¤ç›¸å…³æ•°æ®

5. **å¹¶å‘é™åˆ¶**
   - æ‰¹é‡äº‹ä»¶æœ€å¤š100ä¸ª/æ¬¡
   - APIè°ƒç”¨å»ºè®®é™æµ
   - å¤§é‡æ•°æ®æŸ¥è¯¢ä½¿ç”¨åˆ†é¡µ

---

## ğŸ“ æŠ€æœ¯æ”¯æŒ

### APIæ–‡æ¡£
- å®Œæ•´APIæ–‡æ¡£ï¼š`docs/api-reference.md`
- å®¢æˆ·ç«¯é›†æˆï¼š`docs/vue-client-advertising-tracking.md`
- æµ‹è¯•æŒ‡å—ï¼š`docs/advertising-tracking-test-guide.md`

### æµ‹è¯•å·¥å…·
- Node.jsæµ‹è¯•è„šæœ¬ï¼š`test-advertising-tracking.js`
- HTMLæµ‹è¯•é¡µé¢ï¼š`test-advertising-tracking.html`
- ç³»ç»Ÿæ£€æŸ¥è„šæœ¬ï¼š`check-advertising-system.sh`

### å¸¸è§é—®é¢˜

**Q: å¦‚ä½•æŸ¥çœ‹æŸä¸ªè®¡åˆ’çš„å®æ—¶æ•°æ®ï¼Ÿ**
```bash
curl http://localhost:8080/api/admin/advertising/campaigns/{id}/stats
```

**Q: è½¬åŒ–æ•°æ®ä¸ºä»€ä¹ˆæ²¡æœ‰ï¼Ÿ**
- æ£€æŸ¥å®¢æˆ·ç«¯æ˜¯å¦æ­£ç¡®é›†æˆè¿½è¸ªä»£ç 
- ç¡®è®¤ç”¨æˆ·æ˜¯å¦é€šè¿‡æŠ•æ”¾é“¾æ¥è¿›å…¥
- éªŒè¯è½¬åŒ–è¿½è¸ªAPIæ˜¯å¦è¢«è°ƒç”¨

**Q: å¦‚ä½•å¯¼å‡ºæ•°æ®ï¼Ÿ**
- ä½¿ç”¨APIè·å–æ•°æ®åè‡ªè¡Œå¤„ç†
- æˆ–ç›´æ¥æŸ¥è¯¢æ•°æ®åº“å¯¼å‡º

---

## ğŸ‰ ç³»ç»ŸçŠ¶æ€

âœ… **ç³»ç»Ÿå·²å°±ç»ªï¼Œå¯ä»¥æ­£å¼ä½¿ç”¨**

- æ•°æ®åº“è¡¨ç»“æ„å®Œæ•´
- APIæ¥å£å…¨éƒ¨å¯ç”¨
- æµ‹è¯•éªŒè¯é€šè¿‡
- æ–‡æ¡£é½å…¨

**å¼€å§‹ä½¿ç”¨å§ï¼** ğŸš€
