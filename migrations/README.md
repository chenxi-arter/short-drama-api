# æ•°æ®åº“è¿ç§»è¯´æ˜

## è¿ç§»è„šæœ¬è¯´æ˜

### ä¸»è¦è„šæœ¬

1. **complete-setup.sql** - å®Œæ•´æ•°æ®åº“åˆå§‹åŒ–è„šæœ¬
   - åŒ…å«æ‰€æœ‰è¡¨ç»“æ„ã€ç´¢å¼•ã€æµ‹è¯•æ•°æ®
   - é€‚ç”¨äºæ–°æœåŠ¡å™¨ä¸€é”®éƒ¨ç½²
   - åŒ…å«refresh_tokensè¡¨å’Œç›¸å…³é…ç½®

2. **insert-test-data.sql** - æµ‹è¯•æ•°æ®æ’å…¥è„šæœ¬
   - åŒ…å«ç”¨æˆ·ã€åˆ†ç±»ã€ç³»åˆ—ã€å‰§é›†ç­‰æµ‹è¯•æ•°æ®
   - ç”¨äºå¼€å‘å’Œæµ‹è¯•ç¯å¢ƒ

3. **add-uuid-fields.sql** - UUIDå­—æ®µæ·»åŠ è„šæœ¬
   - ä¸ºä¸»è¦å®ä½“æ·»åŠ UUIDå­—æ®µ
   - å¢å¼ºé˜²æšä¸¾æ”»å‡»èƒ½åŠ›

4. **add-series-filter-fields.sql** - ç³»åˆ—ç­›é€‰å­—æ®µè„šæœ¬
   - æ·»åŠ åœ°åŒºã€è¯­è¨€ã€å‘å¸ƒæ—¥æœŸç­‰ç­›é€‰å­—æ®µ
   - æ”¯æŒé«˜çº§ç­›é€‰åŠŸèƒ½

5. **add-actor-fields-to-series.sql** - æ¼”å‘˜ä¿¡æ¯å­—æ®µè„šæœ¬
   - ä¸ºseriesè¡¨æ·»åŠ ä¸»æ¼”ã€æ¼”å‘˜ã€å¯¼æ¼”å­—æ®µ
   - å¢å¼ºè§†é¢‘è¯¦æƒ…ä¿¡æ¯

6. **add-episode-fields.sql** - å‰§é›†å­—æ®µå¢å¼ºè„šæœ¬
   - ä¸ºepisodeå’Œepisode_urlè¡¨æ·»åŠ æ—¶é—´æˆ³å’Œç»­é›†å­—æ®µ
   - æ·»åŠ é˜²æšä¸¾æ”»å‡»çš„åŠ å¯†ç´¢å¼•

7. **update-series-category-relation.sql** - ç³»åˆ—åˆ†ç±»å…³ç³»æ›´æ–°è„šæœ¬
   - å»ºç«‹seriesä¸categoryçš„ç›´æ¥å…³è”
   - ç§»é™¤å¤šå¯¹å¤šå…³ç³»ï¼Œç®€åŒ–æ•°æ®ç»“æ„

8. **update-categories-complete.sql** - å®Œæ•´åˆ†ç±»è¡¨æ›´æ–°è„šæœ¬ â­ **æ¨èä½¿ç”¨**
   - åˆå¹¶äº†è¡¨ç»“æ„å’Œæ•°æ®æ›´æ–°åŠŸèƒ½
   - ä¸€ç«™å¼åˆ†ç±»è¡¨åˆå§‹åŒ–å’Œæ•°æ®å¡«å……
   - åŒ…å«æ€§èƒ½ä¼˜åŒ–ç´¢å¼•

9. **update-category-data.sql** - åˆ†ç±»æ•°æ®æ›´æ–°è„šæœ¬ âš ï¸ **å·²æ•´åˆ**
   - æ›´æ–°åˆ†ç±»è¡¨æ•°æ®
   - æ ‡å‡†åŒ–åˆ†ç±»ä¿¡æ¯
   - *å»ºè®®ä½¿ç”¨ update-categories-complete.sql æ›¿ä»£*

10. **update-category-table.sql** - åˆ†ç±»è¡¨ç»“æ„æ›´æ–°è„šæœ¬ âš ï¸ **å·²æ•´åˆ**
    - æ›´æ–°åˆ†ç±»è¡¨ç»“æ„
    - æ·»åŠ æ–°å­—æ®µå’Œç´¢å¼•
    - *å»ºè®®ä½¿ç”¨ update-categories-complete.sql æ›¿ä»£*

11. **check-data-stats.sql** - æ•°æ®ç»Ÿè®¡æ£€æŸ¥è„šæœ¬
    - æ£€æŸ¥æ•°æ®åº“æ•°æ®å®Œæ•´æ€§
    - ç”Ÿæˆæ•°æ®ç»Ÿè®¡æŠ¥å‘Š

### è¾…åŠ©è„šæœ¬
12. **run-test-data.sh** - ä¸€é”®æ‰§è¡Œæµ‹è¯•æ•°æ®æ’å…¥çš„Shellè„šæœ¬

## ğŸ“‹ è„šæœ¬åˆ†ç±»è¯´æ˜

### ğŸš€ å®Œæ•´åˆå§‹åŒ–ç±»
- `complete-setup.sql` - é€‚ç”¨äºå…¨æ–°éƒ¨ç½²
- `insert-test-data.sql` - å¼€å‘æµ‹è¯•ç¯å¢ƒæ•°æ®

### ğŸ”§ åŠŸèƒ½å¢å¼ºç±»
- `add-uuid-fields.sql` - å®‰å…¨æ€§å¢å¼º
- `add-series-filter-fields.sql` - ç­›é€‰åŠŸèƒ½
- `add-actor-fields-to-series.sql` - å†…å®¹ä¿¡æ¯å¢å¼º
- `add-episode-fields.sql` - å‰§é›†åŠŸèƒ½å¢å¼º

### ğŸ“Š ç»“æ„ä¼˜åŒ–ç±»
- `update-categories-complete.sql` - â­ **æ¨è** åˆ†ç±»ç³»ç»Ÿå®Œæ•´æ›´æ–°
- `update-series-category-relation.sql` - å…³ç³»ä¼˜åŒ–
- `update-category-data.sql` - âš ï¸ å·²æ•´åˆåˆ° complete ç‰ˆæœ¬
- `update-category-table.sql` - âš ï¸ å·²æ•´åˆåˆ° complete ç‰ˆæœ¬

### ğŸ› ï¸ æ•°æ®ç®¡ç†ç±»
- `check-data-stats.sql` - æ•°æ®ç»Ÿè®¡å’ŒéªŒè¯

## å¦‚ä½•åº”ç”¨è¿ç§»

### é¦–æ¬¡éƒ¨ç½²ï¼ˆå…¨æ–°æ•°æ®åº“ï¼‰

1. è¿æ¥åˆ°MySQLæ•°æ®åº“

```bash
mysql -u [ç”¨æˆ·å] -p [æ•°æ®åº“å]
```

2. æ‰§è¡Œå®Œæ•´æ•°æ®åº“åˆå§‹åŒ–è„šæœ¬

```bash
source /path/to/migrations/complete-setup.sql
```

æˆ–è€…ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ç›´æ¥æ‰§è¡ŒSQLæ–‡ä»¶ï¼š

```bash
mysql -u [ç”¨æˆ·å] -p [æ•°æ®åº“å] < /path/to/migrations/complete-setup.sql
```

**æ³¨æ„ï¼š** complete-setup.sql åŒ…å«äº†æ‰€æœ‰å¿…è¦çš„è¡¨ç»“æ„ã€ç´¢å¼•å’Œrefresh_tokensè¡¨ï¼Œé€‚ç”¨äºä¸€é”®éƒ¨ç½²ã€‚

### æ’å…¥æµ‹è¯•æ•°æ®

åœ¨æ•°æ®åº“åˆå§‹åŒ–å®Œæˆåï¼Œå¯ä»¥æ’å…¥ä¸°å¯Œçš„æµ‹è¯•æ•°æ®ï¼š

```bash
mysql -u [ç”¨æˆ·å] -p [æ•°æ®åº“å] < /path/to/migrations/insert-test-data.sql
```

**æ³¨æ„ï¼š** æµ‹è¯•æ•°æ®è„šæœ¬åŒ…å«äº†å¤§é‡çš„ç¤ºä¾‹æ•°æ®ï¼ŒåŒ…æ‹¬ï¼š
- 16ä¸ªåˆ†ç±»å’Œ25ä¸ªæ ‡ç­¾
- 15ä¸ªç³»åˆ—å‰§é›†
- 20ä¸ªå‰§é›†å’Œå¯¹åº”çš„æ’­æ”¾åœ°å€
- 12ä¸ªçŸ­è§†é¢‘
- 15ä¸ªæµ‹è¯•ç”¨æˆ·
- 24æ¡è¯„è®ºï¼ˆåŒ…æ‹¬å¼¹å¹•ï¼‰
- 19æ¡è§‚çœ‹è¿›åº¦è®°å½•
- ç³»åˆ—å’Œå‰§é›†çš„æ ‡ç­¾å…³è”æ•°æ®

### ä½¿ç”¨è¾…åŠ©è„šæœ¬

#### ä¸€é”®æ’å…¥æµ‹è¯•æ•°æ®
```bash
cd migrations
./run-test-data.sh [æ•°æ®åº“å] [ç”¨æˆ·å]
```

ç¤ºä¾‹ï¼š
```bash
./run-test-data.sh short_drama root
```

#### æŸ¥çœ‹æ•°æ®ç»Ÿè®¡
æ’å…¥æ•°æ®åï¼Œå¯ä»¥æŸ¥çœ‹ç»Ÿè®¡ä¿¡æ¯ï¼š
```bash
mysql -u [ç”¨æˆ·å] -p [æ•°æ®åº“å] < check-data-stats.sql
```

è¿™å°†æ˜¾ç¤ºï¼š
- å„è¡¨çš„è®°å½•æ•°ç»Ÿè®¡
- çƒ­é—¨å†…å®¹TOP5
- ç”¨æˆ·æ´»è·ƒåº¦ç»Ÿè®¡
- è¯„è®ºå’Œè§‚çœ‹è¿›åº¦åˆ†æ

## æ³¨æ„äº‹é¡¹

- åœ¨åº”ç”¨è¿ç§»å‰ï¼Œè¯·ç¡®ä¿å·²å¤‡ä»½æ•°æ®åº“
- è¿ç§»è„šæœ¬ä¼šä¿®æ”¹æ•°æ®åº“ç»“æ„ï¼Œè¯·åœ¨éé«˜å³°æœŸæ‰§è¡Œ
- æ‰§è¡Œå®Œè¿ç§»åï¼Œéœ€è¦é‡å¯åº”ç”¨æœåŠ¡å™¨ä»¥ä½¿æ–°å­—æ®µç”Ÿæ•ˆ